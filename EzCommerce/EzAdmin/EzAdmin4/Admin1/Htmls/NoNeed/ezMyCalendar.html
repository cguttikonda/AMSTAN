<html>
<head>
<Title>EzCommerce  Calender  </Title>
<script language="javascript">
	function noOfDaysInAMonth(aMonth,aYear)
	{
		switch(aMonth)
		{

			case  0 : 
			case  2 :
			case  4 :
			case  6 :
			case  7 :
			case  9 :
			case 11 : n=31;
					break;
		
			case 3 :
			case 5 :
			case 8 :	
			case 10 :	n=30
					break;

			case	1:   if(isLeapYear(aYear))
				     {
					 	n=29;
					}
				      else
					{
						n=28;
					}
					break;
		}
					
		return n;				
		
	}

	function isLeapYear(aYear)
	{	

		if( ((aYear%4==0)&&(aYear%100!=0)) || (aYear%400==0))
		{
			return true;
		}
		else
		{
			return false;
		}
	}	
	
	function showCalendar()
	{
		var yearValue=parent.frames[0].document.forms[0].selYear.options[parent.frames[0].document.forms[0].selYear.selectedIndex].value	
		var monthValue=parent.frames[0].document.forms[0].selMonth.options[parent.frames[0].document.forms[0].selMonth.selectedIndex].value
		myDate = new Date(yearValue,monthValue,1)
		displayCalendar(myDate);
	}
		
 	function displayCalendar(aMyDate)
	{
	   var dy = aMyDate.getDay()
	   var mon = aMyDate.getMonth()
	   var yr = aMyDate.getFullYear()
	   var weekDayFlag = 0
	   var dayCounter = 1

	    document.write("<Table  border='0' cellpadding='0'    cellspacing='0' width='100%'>")
	    document.write("<Tr>");
	    document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>SUN</Td>")
	    document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>MON</Td>")
            document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>TUE</Td>")
	    document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>WED</Td>")
            document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>THU</Td>")
	    document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>FRI</Td>")
	    document.write("<Td width='12%' align='center'><font size='2' face='Verdana' color='#006600'>SAT</Td>")
	    document.write("</Tr>")


	//Printing White Spaces

	document.write("<Tr>")
	for(spaceCounter=0;spaceCounter<dy;spaceCounter++)
	{
	      document.write('<Td></Td>');
	      weekDayFlag++;
	}  	


	var noOfDays = noOfDaysInAMonth(mon,yr)
	for(dayCount=1;dayCount<=noOfDays;dayCount++)
	{
		
		isWeekDay=weekDayFlag%7
		if(isWeekDay==0)
		{
			document.write("</Tr><Tr>")
			document.write("<Td width='13%' align='center'><a style='text-decoration:none' href='javaScript:getSelDate("+weekDayFlag%7+","+dayCount+","+mon+","+yr+")'><font size='2' face='Verdana' color='#8B2323'>"+ dayCount +"</font></a></Td>")
			
		}
		else if(isWeekDay==6)
		{
			document.write("<Td width='13%' align='center'><a style='text-decoration:none' href='javaScript:getSelDate("+weekDayFlag%7+","+dayCount+","+mon+","+yr+")'><font size='2' face='Verdana' color='#8B2323'>"+ dayCount +"</font></a></Td>")
			
		}
		else
		{
		        document.write("<Td width='13%' align='center'><a  style='text-decoration:none' href='JavaScript:getSelDate("+weekDayFlag%7+","+dayCount+","+mon+","+yr+")'><font size='2' face='Verdana' color='#9ACD32'>" + dayCount +"</font></a></Td>")
		}

	       weekDayFlag++;
	}
	document.write("</Tr></Table>")
	}


	function getSelDate(selDay,selDate,selMonth,selYear)
	{  
		
		++selMonth
		opFd=eval(top.name)
		opFd.value= selMonth + "/" + selDate + "/" + selYear
		parent.close();
	}	
	function getToday()
	{      
		var toDay = new Date()
		selDate = toDay.getDate()
	        selMonth = toDay.getMonth()
		selYear = toDay.getYear()	
		selDay = toDay.getDay()
		switch(selDay)
		{
			case  0 : n="Sun"	
					break;
			case  1 : n="Mon" 
					break;
			case  2 : n="Tue" 
					break;
			case  3 : n="Wed" 
					break;
			case  4 : n="Thu" 
					break;
			case  5 : n="Fri" 
					break;
			case  6 : n="Sat" 
					break;
		}
		++selMonth
		opFd=eval(top.name)
		opFd.value= selMonth + "/" + selDate + "/" + selYear
		parent.close();
	}	

</script>
</head>
<body bgcolor="#FFFFFF">
<script>
showCalendar()
</script>
<form name=abc>
<center>
    <a style='text-decoration:none' href="javaScript:getToday()"><font color="#0000FF"><b><font face="Verdana, Arial, Helvetica, sans-serif" size="2">Today</font></b></font></a> 
  </center>
<input type=hidden name=h1>
</form>
</body>
</html>